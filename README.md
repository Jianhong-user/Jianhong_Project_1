# roLabelImg - 增强版旋转框标注工具

[![Python](https://img.shields.io/badge/Python-3.6+-blue.svg)](https://www.python.org/)
[![PyQt5](https://img.shields.io/badge/PyQt5-5.0+-green.svg)](https://pypi.org/project/PyQt5/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

基于 `labelImg` 重写的图形图像标注工具，专为旋转矩形区域标注设计，同时兼容传统矩形标注。本项目在原有功能基础上进行了大量增强和优化。

## ✨ 新增功能特性

### 🎯 核心增强
- ✅ **旋转矩形标注**：支持绘制任意角度的旋转矩形框
- ✅ **传统矩形标注**：完全兼容标准水平矩形框标注
- ✅ **XML 格式输出**：标准 Pascal VOC XML 格式，兼容主流深度学习框架

### 🚀 效率提升
- ✨ **批量删除功能**：支持多选标签并批量删除，大幅提高标注效率
  - 支持 `Ctrl+点击` 多选标签
  - 支持 `Shift+点击` 范围选择
  - 支持 `Ctrl+A` 全选标签
  - 支持 `Delete` 键或 `Ctrl+Shift+D` 批量删除
  - 删除前确认对话框，防止误操作

- ✨ **撤销功能**：完整的撤销系统
  - 支持 `Ctrl+Z` 撤销操作
  - 支持添加、删除、批量删除等操作的撤销
  - 最多支持20步撤销历史
  - 切换图片时自动清空撤销历史

- ✨ **自动保存**：智能保存机制
  - 切换图片时自动保存当前标注
  - 支持前进（D键）和后退（A键）时的自动保存
  - 避免标注丢失，提高工作效率

### 🎨 视觉体验
- ✨ **标注特效**：丰富的视觉反馈
  - 绘制过程中的动态边框和脉冲效果
  - 角点标记和辅助线显示
  - 完成标注时的圆环扩散特效
  - 音效反馈（可选）

- ✨ **随机颜色系统**：
  - 每次启动时为标签分配随机颜色
  - 26种精心挑选的美观颜色
  - 提高不同标签的视觉区分度
  - 支持颜色缓存和智能分配

- ✨ **统计面板优化**：
  - 实时显示标注框总数
  - 分别统计旋转框和普通框数量
  - 移除冗余的困难样本统计
  - 清晰的数据展示

## 🛠️ 安装和运行

### 环境要求
- Python 3.6+
- PyQt5
- lxml
- Pillow

### 安装依赖
```bash
pip install PyQt5 lxml Pillow
```

### 运行程序
```bash
python roLabelImg.py
```

## 🎮 快速上手

### 基本操作流程
1. **打开目录**：按 `Ctrl+U` 打开包含图像的目录
2. **选择标注模式**：
   - 按 `W` 键激活旋转矩形标注模式
   - 按 `E` 键激活普通矩形标注模式
3. **绘制标注框**：在图像上拖动鼠标绘制矩形
4. **调整角度**（旋转框）：选中顶点后右键拖动或使用 `ZXCV` 键
5. **输入标签**：绘制完成后输入类别标签
6. **保存标注**：按 `Ctrl+S` 保存或自动保存
7. **切换图像**：按 `D` 下一张，按 `A` 上一张

### 批量操作
1. **多选标签**：
   - 按住 `Ctrl` 键点击多个标签
   - 按住 `Shift` 键选择连续范围
   - 按 `Ctrl+A` 全选所有标签

2. **批量删除**：
   - 选中多个标签后按 `Delete` 键
   - 或使用快捷键 `Ctrl+Shift+D`
   - 或右键菜单选择"批量删除"

3. **撤销操作**：
   - 按 `Ctrl+Z` 撤销最近的操作
   - 支持连续撤销多步操作

## ⌨️ 快捷键参考

### 标注操作
- `W` - 创建旋转矩形框
- `E` - 创建普通矩形框
- `Delete` / `F` - 删除标注框
- `Ctrl+D` - 复制标注框
- `Ctrl+Z` - 撤销操作

### 批量操作
- `Ctrl+A` - 全选标签
- `Ctrl+Shift+D` - 批量删除
- `Delete` - 批量删除选中标签（在标签列表中）

### 图像浏览
- `D` - 下一张图像（自动保存）
- `A` - 上一张图像（自动保存）
- `Space` - 验证图像

### 文件操作
- `Ctrl+O` - 打开图像
- `Ctrl+U` - 打开目录
- `Ctrl+S` - 保存标注
- `Ctrl+Q` - 退出程序

### 视图控制
- `Ctrl++` / `Ctrl+-` - 缩放图像
- `Ctrl+F` - 适应窗口
- `R` / `N` - 切换旋转框/普通框显示

## 📁 输出格式

标注结果保存为 XML 格式，兼容 Pascal VOC 数据集格式：

```xml
<annotation>
    <folder>images</folder>
    <filename>example.jpg</filename>
    <size>
        <width>640</width>
        <height>480</height>
        <depth>3</depth>
    </size>
    <object>
        <name>car</name>
        <pose>Unspecified</pose>
        <truncated>0</truncated>
        <difficult>0</difficult>
        <robndbox>
            <cx>320.0</cx>
            <cy>240.0</cy>
            <w>100.0</w>
            <h>50.0</h>
            <angle>0.5</angle>
        </robndbox>
    </object>
</annotation>
```

## 🎯 使用技巧

### 高效标注
- 使用 `W` 键快速切换到旋转框模式
- 利用 `ZXCV` 键进行精确角度调整
- 使用方向键进行像素级位置调整
- 利用批量删除功能快速清理错误标注

### 批量管理
- 使用 `Ctrl+A` 全选后批量删除重新开始
- 利用 `Ctrl+点击` 选择特定类型的标签进行批量操作
- 使用撤销功能快速恢复误删的标注

### 视觉优化
- 享受绘制过程中的动态特效反馈
- 利用随机颜色系统区分不同类别
- 使用统计面板监控标注进度

## 🔧 技术特性

### 架构优化
- 基于 PyQt5 的现代化界面
- 模块化的代码结构
- 完整的异常处理机制
- 高效的内存管理

### 性能提升
- 优化的图像渲染算法
- 智能的界面更新机制
- 高效的批量操作处理
- 流畅的动画特效系统

### 兼容性
- 支持常见图像格式（JPG、PNG、BMP等）
- 兼容 Pascal VOC XML 格式
- 支持主流深度学习框架
- 跨平台运行支持

## 📚 文档

- [详细使用说明](roLabelImg使用说明.md) - 完整的功能介绍和操作指南
- [快捷键参考](roLabelImg使用说明.md#完整快捷键参考) - 所有快捷键的详细说明

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 📄 许可证

本项目基于 MIT 许可证开源。

## 🙏 致谢

本项目基于 [labelImg](https://github.com/tzutalin/labelImg) 进行开发，感谢原作者的贡献。

---

**让标注工作变得更高效、更有趣！** 🎉
